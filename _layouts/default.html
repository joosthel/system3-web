<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}</title>
    <link rel="shortcut icon" type="image/x-icon" href="{{ "/favicon.ico" | relative_url }}">
    <link rel="stylesheet" href="{{ "/assets/css/main.css" | relative_url }}">
    {% feed_meta %}
    {% seo %}
  </head>
  <body>
    {% include header.html %}
    
    <main class="page-content" aria-label="Content">
      {{ content }}
    </main>
    
    {% include footer.html %}

    <!-- Slideshow JavaScript -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Footer Timestamp
        function updateBerlinTime() {
          const berlinTime = new Date().toLocaleTimeString('en-US', {
            timeZone: 'Europe/Berlin',
            hour: '2-digit', 
            minute: '2-digit',
            second: '2-digit',
            hour12: false
          });
          document.getElementById('berlin-time').textContent = berlinTime + ' CET';
        }
        
        updateBerlinTime();
        setInterval(updateBerlinTime, 1000);        
        
        // Slideshow functionality
        const slideshowImages = document.querySelectorAll('.slideshow-image');
        if (slideshowImages.length > 1) {
          let currentSlide = 0;
          
          function nextSlide() {
            slideshowImages[currentSlide].classList.remove('active');
            currentSlide = (currentSlide + 1) % slideshowImages.length;
            slideshowImages[currentSlide].classList.add('active');
          }
          
          // Change image every 3 seconds (3000ms)
          setInterval(nextSlide, 3000);
        }
      
        // Mobile menu toggle functionality
        const menuToggle = document.querySelector('.mobile-menu-toggle');
        const navMenu = document.querySelector('.header-right');
        
        if (menuToggle && navMenu) {
          menuToggle.addEventListener('click', function() {
            navMenu.classList.toggle('active');
            menuToggle.classList.toggle('active');
            document.body.classList.toggle('menu-open'); 
          });
          
          const navLinks = navMenu.querySelectorAll('a');
          navLinks.forEach(link => {
            link.addEventListener('click', function() {
              navMenu.classList.remove('active');
              menuToggle.classList.remove('active');
              document.body.classList.remove('menu-open');
            });
          });
        }

        // Portfolio carousel functionality
        const carousel = document.querySelector('.portfolio-carousel');
        const prevBtn = document.querySelector('.carousel-prev');
        const nextBtn = document.querySelector('.carousel-next');
        // Note: querySelectorAll for indicators will be used after they are added to home.html
        
        if (carousel && prevBtn && nextBtn) {
          const cards = carousel.querySelectorAll('.portfolio-card');
          let currentIndex = 0;
          const totalCards = cards.length;
          
          if (totalCards === 0) return;

          // Dynamically select indicators after they are added to the DOM
          const indicators = document.querySelectorAll('.carousel-indicators .indicator');
          
          function updateIndicators() {
            indicators.forEach((indicator, idx) => {
              indicator.classList.toggle('active', idx === currentIndex);
            });
          }
          
          function getCardWidth() {
            // Each card is set to 100% width of the carousel container by CSS
            return carousel.parentElement.offsetWidth;
          }
          
          function updateCarouselPosition() {
            const width = getCardWidth();
            carousel.style.transform = `translateX(${-currentIndex * width}px)`;
            if (indicators.length > 0) {
              updateIndicators();
            }
          }
          
          updateCarouselPosition();
          
          prevBtn.addEventListener('click', function() {
            currentIndex = (currentIndex > 0) ? currentIndex - 1 : totalCards - 1;
            updateCarouselPosition();
          });
          
          nextBtn.addEventListener('click', function() {
            currentIndex = (currentIndex < totalCards - 1) ? currentIndex + 1 : 0;
            updateCarouselPosition();
          });
          
          window.addEventListener('resize', function() {
            updateCarouselPosition();
          });
          
          if (indicators.length > 0) {
            updateIndicators(); // Initial call
            // Add click event listeners for indicators if they are buttons
            indicators.forEach((indicator, idx) => {
              indicator.addEventListener('click', () => {
                currentIndex = idx;
                updateCarouselPosition();
              });
            });
          }
        }
      });
  </script>
  </body>
</html>